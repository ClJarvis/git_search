<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="Web site created using create-react-app"
    />
   
    <link rel="manifest" href="%PUBLIC_URL%/src/manifest.json" />

    <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

   
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="src/gitSearch.css">
    <title>Issue Search</title>
  </head>

  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    
    <div class="main">
      <h1>OUTER Open Source Issue Search</h1>
      <form id="searchForm" class="form-inline mx-auto">
      <div class="instructions">
        Enter a GitHub username to see if they have repositories with open issues.
      </div>
        <input id="userInput" class="form-control mb-5" type="text" name="username" placeholder="Enter GitHub Username">
        <input id="searchBtn" type="submit" value="Submit" onclick="RepoSearch()">
      </form>

      <ul id="notFound" class="list-group mx-auto mb-5" style="width: 500px"></ul>

      <ul id="searchUsers" class="list-group mx-auto mb-5" style="width: 500px">

      </ul>
    </div> 
    <script>
      
const searchForm = document.getElementById('searchForm');

searchForm.addEventListener('submit', (e) => {
  e.preventDefault();

  let userInput = document.getElementById('userInput');
  let username = userInput.value;
  RepoSearch(username);

})


async function RepoSearch(username) {
  const reqst = new XMLHttpRequest();


const url = await `https://api.github.com/users/${username}/repos`;

  reqst.open('GET', url, true);

  document.getElementById("searchUsers").innerHTML=""

  reqst.onload = function() {
    const data = JSON.parse(this.response);

    for (let i in data){
      let div = document.getElementById('searchUsers');

      let p = document.createElement('p');

      p.classList.add('list-group-item');


       if (data[i].open_issues_count >= 1) {

            p.innerHTML = (`
             <p><h3> <a href="${data[i].owner.html_url}" target="blank">${data[i].owner.login.charAt(0).toUpperCase() + data[i].owner.login.slice(1)}'s</a> Repos</h3></p>
        <p class="avatarpic"><img class="avatar" src="${data[i].owner.avatar_url}" class="avatar"/></p>     
                <p><strong>Repo:</strong> <a href="${data[i].html_url}" target=blank_">${data[i].name.charAt(0).toUpperCase() + data[i].name.slice(1)}</a></p>
                <p><strong>Description:</strong> ${data[i].description}</p>
                <p><strong>Open Issues count:</strong> ${data[i].open_issues_count}</p>
                <p><strong>Open Issues page:</strong> <a href="${data[i].html_url}/issues" target=blank_">View Open Issues on GitHub</a></p>
                <p><strong>Primary Language:</strong> ${data[i].language}</p>
                <p><strong>Topics:</strong> ${data[i].topics.join(", ")}</p>
            `);
           
            div.appendChild(p);
    } 

  }   

  console.log(data);

  }

  reqst.send();

}



    </script>
 <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  </body>
</html>
